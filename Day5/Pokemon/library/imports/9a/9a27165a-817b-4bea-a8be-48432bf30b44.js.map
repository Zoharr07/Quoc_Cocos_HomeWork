{"version":3,"sources":["../../../../assets/Scripts/assets/Scripts/CharController.js"],"names":["Emiter","require","cc","Class","extends","Component","properties","char","Node","spAnim","sp","Skeleton","footStepAudio","AudioSource","_usingAction","onLoad","instance","addEvent","_changeActionType","bind","_goLeft","_goRight","_jumpChar","_resetChar","setEventListener","entry","event","data","log","name","play","setMix","scaleX","goLeft","moveBy","easing","easeQuarticActionOut","runAction","tween","by","position","v2","start","setAnimation","addAnimation","goRight","jump","jumpBy","easeInOut","emit","action"],"mappings":"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","file":"CharController.js","sourceRoot":"../../../../assets/Scripts","sourcesContent":["const Emiter = require('Emitter');\n\ncc.Class({\n    extends: cc.Component,\n    properties: {\n        char: cc.Node,\n        spAnim: sp.Skeleton,\n        footStepAudio: cc.AudioSource,\n\n        _usingAction: '',\n    },\n\n    onLoad() {\n        Emiter.instance = new Emiter();\n        Emiter.instance.addEvent(\"changeAction\", this._changeActionType.bind(this));\n        Emiter.instance.addEvent(\"goleft\", this._goLeft.bind(this));\n        Emiter.instance.addEvent(\"goright\", this._goRight.bind(this));\n        Emiter.instance.addEvent(\"jump\", this._jumpChar.bind(this));\n        Emiter.instance.addEvent(\"reset\", this._resetChar.bind(this));\n        this.spAnim.setEventListener((entry, event) => {\n            const { data } = event;\n            cc.log(data.name);\n            if (data.name == 'footstep') this.footStepAudio.play()\n\n        });\n        this.spAnim.setMix('jump', 'idle', 0.2);\n    },\n\n\n    _goLeft() {\n        if (this.char.scaleX == 1) this.char.scaleX = -1;\n\n        if (this._usingAction == 'CCAction') {\n            let goLeft = cc.moveBy(3, -120, 0);\n            goLeft.easing(cc.easeQuarticActionOut(2.0));\n            this.char.runAction(goLeft);\n        } else if (this._usingAction == 'TweenAction') {\n            cc.tween(this.char)\n                .by(3, { position: cc.v2(-120, 0) }, { easing: 'quartOut' })\n                .start()\n        }\n\n        this.spAnim.setAnimation(0, 'walk', false);\n        this.spAnim.addAnimation(0, 'idle', true);\n    },\n\n    _goRight() {\n        if (this.char.scaleX == -1) this.char.scaleX = 1;\n\n        if (this._usingAction == 'CCAction') {\n            let goRight = cc.moveBy(3, 120, 0);\n            goRight.easing(cc.easeQuarticActionOut(2.5));\n            this.char.runAction(goRight);\n        } else if (this._usingAction == 'TweenAction') {\n            cc.tween(this.char)\n                .by(3, { position: cc.v2(120, 0) }, { easing: 'quartOut' })\n                .start()\n        }\n\n        this.spAnim.setAnimation(0, 'walk', false);\n        this.spAnim.addAnimation(0, 'idle', true);\n    },\n\n    _jumpChar() {\n        let jump = cc.jumpBy(1, 50 * this.char.scaleX, 0, 10, 1);\n        jump.easing(cc.easeInOut(1));\n        this.char.runAction(jump);\n\n        this.spAnim.setAnimation(0, 'jump', false);\n        this.spAnim.addAnimation(0, 'idle', true);\n    },\n\n    _resetChar() {\n        this.char.position = cc.v2(0, -200);\n        Emiter.instance.emit('setbutton', true);\n    },\n\n    _changeActionType(action) {\n        this._usingAction = action;\n        cc.log(action);\n    },\n});\n"]}