{"version":3,"sources":["CharController.js"],"names":["Emiter","require","cc","Class","extends","Component","properties","frameAnim","isLeft","isRight","isJump","char","Node","_counter","onLoad","instance","addEvent","_goLeft","bind","_goRight","_jumpChar","_resetChar","update","dt","emit","_resetFlag","_moveLeft","_moveRight","_jump","start","position","v2","angle","scaleX","x","y"],"mappings":"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","file":"CharController.js","sourceRoot":"../../../../assets/Scripts","sourcesContent":["const Emiter = require('Emitter');\n\ncc.Class({\n    extends: cc.Component,\n    properties: {\n        frameAnim: 40,\n        isLeft: false,\n        isRight: false,\n        isJump: false,\n        char: cc.Node,\n        _counter: 0,\n    },\n\n    onLoad() {\n        Emiter.instance = new Emiter();\n        Emiter.instance.addEvent(\"goleft\", this._goLeft.bind(this));\n        Emiter.instance.addEvent(\"goright\", this._goRight.bind(this));\n        Emiter.instance.addEvent(\"jump\", this._jumpChar.bind(this));\n        Emiter.instance.addEvent(\"reset\", this._resetChar.bind(this));\n    },\n\n    update(dt) {\n        if (this.isLeft || this.isRight || this.isJump) {\n            Emiter.instance.emit('setbutton', false);\n            Emiter.instance.emit('inputstatus', false);\n            if (this._counter >= this.frameAnim) {\n                this._resetFlag();\n                Emiter.instance.emit('setbutton', true);\n                Emiter.instance.emit('inputstatus', true);\n                this._counter = 0;\n                return;\n            }\n            if (this.isLeft) this._moveLeft();\n            if (this.isRight) this._moveRight();\n            if (this.isJump) this._jump();\n            this._counter++;\n        }\n    },\n\n    start() {\n        this._resetChar();\n    },\n\n    _goLeft() {\n        this.isLeft = true;\n    },\n\n    _goRight() {\n        this.isRight = true;\n    },\n\n    _jumpChar() {\n        this.isJump = true;\n    },\n\n    _resetChar() {\n        this.char.position = cc.v2(480, 185);\n        this.char.angle = 0;\n        this._resetFlag();\n        Emiter.instance.emit('setbutton', true);\n        this._counter = 0;\n    },\n\n    _resetFlag() {\n        this.isLeft = false;\n        this.isRight = false;\n        this.isJump = false;\n    },\n\n    _moveLeft() {\n        if (this.char.scaleX < 0) {\n            this.char.scaleX *= -1;\n        }\n        this.char.x += -3;\n    },\n    _moveRight() {\n        if (this.char.scaleX > 0) {\n            this.char.scaleX *= -1;\n        }\n        this.char.x += 3;\n    },\n    _jump() {\n        if (this._counter < (this.frameAnim / 2)) {\n            this.char.y += 1;\n        } else {\n            this.char.y -= 1;\n        }\n        if (this._counter >= (this.frameAnim * 1 / 4) && this._counter < this.frameAnim) {\n            if (this.char.scaleX > 0) {\n                this.char.angle += 360 / (this.frameAnim * 3 / 4);\n            } else this.char.angle -= 360 / (this.frameAnim * 3 / 4);\n        }\n    }\n});\n"]}